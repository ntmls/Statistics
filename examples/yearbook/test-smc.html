<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>Test Runner</title>
	<link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-2.3.3.css">
	<script src="https://code.jquery.com/qunit/qunit-2.3.3.js"></script>
    <script src="fun.js"></script>
    <script src="../../src/distributions.js"></script>
    <script src="../../src/list.js"></script>
    <script src="model.js"></script>
    <script src="smc.js"></script>
    </head>
    <body>
        <script> 
            
            QUnit.test("getPixel", function(assert) {
                let point = new Point(100, 100); 
                let image = document.getElementById("image");
                let imageData = getImageData(image);
                let actual = getPixel(imageData)(point);
                assert.equal(actual.red, 64); 
                assert.equal(actual.green, 60); 
                assert.equal(actual.blue, 58); 
            });
            
            QUnit.test("sampleImage", function(assert) {
                let image = document.getElementById("image");
                let imageData = getImageData(image);
                let samples = sampleImage(imageData, 50);
                let notZero = function(n) { return n != 0; };
                let reds = samples.map(function(s) { return s.color.red; });
                let greens = samples.map(function(s) { return s.color.green; });
                let blues = samples.map(function(s) { return s.color.blue; });
                assert.equal(samples.length, 50);
                assert.equal(any(notZero)(reds), true);
                assert.equal(any(notZero)(greens), true);
                assert.equal(any(notZero)(blues), true);
            });
            
            QUnit.test("compare", function(assert) {
                let image = document.getElementById("image");
                let imageData = getImageData(image);
                let samples = sampleImage(imageData, 500);
                let modelParams = new ModelParams(0,0,20,30,5,4,5);
                let model = generateModel(modelParams);
                let dist = compare(samples, model);
                assert.ok(dist > 100);
            });
            
            QUnit.test("scheduleThresholds", function(assert) {
                let schedule = scheduleThresholds(50, 5);
                assert.equal(schedule.value, 50);
                schedule = schedule.next;
                assert.equal(schedule.value, 40);
                schedule = schedule.next;
                assert.equal(schedule.value, 30);
                schedule = schedule.next;
                assert.equal(schedule.value, 20);
                schedule = schedule.next;
                assert.equal(schedule.value, 10);
                schedule = schedule.next;
                assert.equal(schedule.value, 0);
                schedule = schedule.next;
                assert.equal(schedule.value, undefined);
            });


        </script>
        
        <div id="qunit"></div>
        <img id="image" src="pg1.jpg" />
    </body>
</html>